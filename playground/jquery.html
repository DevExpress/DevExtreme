<!DOCTYPE html>
<html>
<head>
    <title>DevExtreme jQuery Example</title>

    <link rel="stylesheet" type="text/css" href="../artifacts/css/dx.common.css"/>

    <link rel="stylesheet" type="text/css" href="../artifacts/css/dx.light.css"/>

    <script type="text/javascript" src="../artifacts/js/jquery.js"></script>

    <!--<script type="text/javascript" src="../artifacts/js/cldr.js"></script>
    <script type="text/javascript" src="../artifacts/js/cldr/event.js"></script>
    <script type="text/javascript" src="../artifacts/js/cldr/supplemental.js"></script>
    <script type="text/javascript" src="../artifacts/js/cldr/unresolved.js"></script>
    <script type="text/javascript" src="../artifacts/js/globalize.js"></script>
    <script type="text/javascript" src="../artifacts/js/globalize/currency.js"></script>
    <script type="text/javascript" src="../artifacts/js/globalize/date.js"></script>
    <script type="text/javascript" src="../artifacts/js/globalize/message.js"></script>
    <script type="text/javascript" src="../artifacts/js/globalize/number.js"></script>-->

    <script type="text/javascript" src="../artifacts/js/dx.all.debug.js"></script>
    <style>

        .dx-validation-pending.dx-texteditor.dx-editor-filled .dx-texteditor-input-container .dx-pending-indicator,
        .dx-validation-pending.dx-texteditor.dx-editor-underlined .dx-texteditor-input-container .dx-pending-indicator,
        .dx-validation-pending.dx-texteditor.dx-editor-outlined .dx-texteditor-input-container .dx-pending-indicator {
            pointer-events: none;
            position: absolute;
            top: 50%;
            margin-top: -11px;
            width: 22px;
            height: 22px;
        }
        .dx-texteditor.dx-validation-pending .dx-texteditor-input-container .dx-pending-indicator {
             right: 4px;
        }
        .dx-texteditor.dx-validation-pending .dx-texteditor-input-container .dx-texteditor-input {
            padding-right: 26px;
        }

        @keyframes valid-check {
            from {
                opacity: 0;
                transform: scale(0.1);
            }
            to {
                opacity: 1;
                transform: scale(1)
            }
        }


        .dx-valid.dx-texteditor.dx-editor-filled .dx-texteditor-input-container:after,
        .dx-valid.dx-texteditor.dx-editor-underlined .dx-texteditor-input-container:after,
        .dx-valid.dx-texteditor.dx-editor-outlined .dx-texteditor-input-container:after {
            pointer-events: none;
            font-weight: bold;
            font-family: "DXIcons";
            color: #5cb85c;
            content: "\f005";
            position: absolute;
            top: 50%;
            margin-top: -9px;
            width: 18px;
            height: 18px;
            text-align: center;
            line-height: 18px;
            font-size: 13px;
            right: 4px;
            opacity: 0;
            transform: scale(0);
            animation: valid-check .3s cubic-bezier(1.000, 0.008, 0.565, 1.650) .1s 1 forwards;
        }
        .dx-valid.dx-texteditor .dx-texteditor-input-container .dx-texteditor-input {
            padding-right: 26px;
        }
    </style>
</head>
<body>
    <div>
        <div>
            <div class="myClass">
            </div>
        </div>
    </div>
    <form id="form" action="your-action" style="width:400px;">
        <div class="dx-fieldset">
            <div class="dx-field">
                <div class="dx-field-label">Text 1</div>
                <div class="dx-field-value">
                    <div id="textBox1"></div>
                </div>
            </div>
            <div class="dx-field">
                <div class="dx-field-label">Text 2</div>
                <div class="dx-field-value">
                    <div id="textBox2"></div>
                </div>
            </div>
            <div class="dx-field">
                <div class="dx-field-label">Text 3</div>
                <div class="dx-field-value">
                    <div id="textBox3"></div>
                </div>
            </div>
        </div>
        <div id="summary"></div>
        <div id="button"></div>
    </form>
    <script>
        $(function() {
            $("#textBox1").dxSelectBox({
                items: [1, 2, 3]
            }).dxValidator({
                    validationRules: [{
                        type: "required",
                        message: "textBox1 is required"
                    },
                    {
                        type: "custom",
                        message: "textBox1 is invalid",
                        validationCallback: function(params) {
                            return params.value === 1;
                        }
                    },
                    {
                        type: "async",
                        message: "textBox1 is invalid (async)",
                        validationCallback: function(params) {
                            let d = $.Deferred();
                            setTimeout(function() {
                                d.resolve(params.value === 1);
                            }, 5000);
                            return d.promise();
                        }
                    }]
                });
            $("#textBox2").dxTextBox({})
                .dxValidator({
                    validationRules: [{
                        type: "required",
                        message: "textBox2 is required"
                    },
                    {
                        type: "custom",
                        message: "textBox2 is invalid",
                        validationCallback: function(params) {
                            return params.value === "test1";
                        }
                    },
                    {
                        type: "async",
                        message: "textBox2 is invalid async",
                        validationCallback: function(params) {
                            let d = $.Deferred();
                            setTimeout(function() {
                                let res = params.value === "test12";
                                if (res) {
                                    d.reject({
                                        isValid: false,
                                        message: "textBox2 value is too simple"
                                    })
                                }
                                else {
                                    d.resolve(true);
                                }
                            }, 3000);
                            return d.promise();
                        }
                    }]
                });
            $("#textBox3").dxTextBox({})
                .dxValidator({
                    validationRules: [{
                        type: "async",
                        reevaluate: true,
                        message: "textBox3 is invalid async1",
                        validationCallback: function(params) {
                            let d = $.Deferred();
                            setTimeout(function() {
                                d.resolve(params.value === "test22");
                            }, 1000);
                            return d.promise();
                        }
                    },
                    {
                        type: "async",
                        message: "textBox3 is invalid async2",
                        validationCallback: function(params) {
                            let d = $.Deferred();
                            setTimeout(function() {
                                let res = params.value === "test223";
                                if (res) {
                                    d.reject({
                                        isValid: false,
                                        message: "textBox3 value is too simple"
                                    })
                                }
                                else {
                                    d.resolve(true);
                                }
                            }, 3000);
                            return d.promise();
                        }
                    },
                    {
                        type: "required",
                        message: "textBox3 is required"
                    }]
                });
            $("#summary").dxValidationSummary({ });
            $("#button").dxButton({
                text: "Register",
                type: "success",
                icon: "check",
                useSubmitBehavior: true
                // onClick: function(params) {
                //     let res = params.validationGroup.validate();
                //     debugger;
                //     //params.validationGroup.reset();
                //     res.complete && res.complete.then(function(value) {
                //         console.log("complete");
                //     });
                // }
            });
        });
    </script>
</body>
</html>
