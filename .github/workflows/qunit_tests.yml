name: QUnit tests

on: [push, pull_request]

jobs:
  qunit-tests:
    strategy:
      fail-fast: true
      matrix:
        CONSTEL: [ export, misc, ui, ui.widgets(1/2), ui.widgets(2/2), ui.editors, ui.grid, ui.scheduler(1/2), ui.scheduler(2/2), viz, renovation ]

    runs-on: ubuntu-latest
    name: Constel ${{ matrix.CONSTEL }}
    timeout-minutes: 60

    steps:

    - name: Get sources
      uses: actions/checkout@v2

    - name: Prepare
      uses: ./.github/actions/prepare-qunit

    - name: Run QUnit tests
      env:
        CONSTEL: ${{ matrix.CONSTEL }}
        NORENOVATION: "true"
        GITHUBACTION: "true"
        TARGET: "test"
      run: |
        chmod +x ./docker-ci.sh
        ./docker-ci.sh
